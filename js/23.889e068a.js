(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[23],{bbc6:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("q-page",{staticClass:"container flex-center h-100",attrs:{id:"petpage"}},[s("div",{staticClass:"row flex-center h-100 petpage_row"},[s("div",{staticClass:"flex-center column col-10 col-lg-6 box h-100 "},[s("img",{staticClass:"col-10",attrs:{src:t.petpage.src}})]),s("div",{staticClass:"column col-10 col-lg-6 right justify-center"},[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col-3 name"},[t._v(t._s(t.petpage.name))]),s("div",{staticClass:"col-3 master"},[t._v("@"+t._s(t.master[0].name))]),s("q-btn",{staticClass:"mail_btn",attrs:{icon:"mail",color:"primary",size:"15px",rounded:""},on:{click:function(e){return t.sendMail(t.petpage)}}},[t._v("寄信給牠")])],1),s("div",[s("p",{staticClass:"pet_des",domProps:{innerHTML:t._s(t.html(t.petpage.description))}})]),s("div",{staticClass:"line"}),s("div",{staticClass:"row type"},[s("div",{staticClass:"animal"},[t._v(t._s(t.petpage.animal))]),s("div",{staticClass:"breed"},[t._v(t._s(t.petpage.breed))])])])]),s("q-dialog",{model:{value:t.mail,callback:function(e){t.mail=e},expression:"mail"}},[s("q-card",{staticClass:"flex row",attrs:{id:"sendMail"}},[s("div",{staticClass:"col-12 flex flex-center column top"},[s("div",{staticClass:"flex justify-end",staticStyle:{width:"100%"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:"",color:"primary"}})],1),s("q-icon",{attrs:{name:"rate_review",color:"primary",size:"3rem"}}),s("p",{staticClass:"title"},[t._v("寄信給牠")])],1),s("div",{staticClass:"col-12 flex justify-center cloumn qes_div"},[s("q-form",{staticClass:"q-form",on:{submit:t.onSubmit,reset:t.onReset}},[s("q-input",{staticClass:"input_title",attrs:{filled:"",label:"請輸入主旨"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}}),s("q-input",{staticClass:"textarea",attrs:{filled:"",type:"textarea",color:"primary",label:"內文"},model:{value:t.textarea,callback:function(e){t.textarea=e},expression:"textarea"}}),s("div",{staticClass:"flex flex-center btn"},[s("q-btn",{staticStyle:{"margin-right":"1rem",width:"80px"},attrs:{rounded:"",label:"送出",type:"submit",color:"primary",size:"1.1rem"}}),s("q-btn",{staticStyle:{width:"80px"},attrs:{rounded:"",label:"重置",type:"reset",color:"accent",size:"1.1rem"}})],1)],1)],1)])],1)],1)},i=[],r=(s("5319"),{data(){return{petpage:{},mail:!1,title:"",textarea:"",allUsers:[],allPets:[]}},computed:{user(){return this.$store.state.user},master(){return this.allUsers.filter((t=>{if(t._id===this.petpage.user)return t}))},getUserPet(){return this.allPets.filter((t=>{if(this.user.id===t.user)return t;console.log(this.user.id)}))}},methods:{html(t){return t.replace(/\n/g,"<br>").replace(/(https?:\/\/[\w-.]+(:\d+)?(\/[\w/.]*)?(\?\S*)?(#\S*)?)/g,'<a href="$1" target="_blank" >$1</a>')},sendMail(t){""===this.user.account?this.$swal.fire({icon:"error",title:"錯誤",text:"請先登入會員",confirmButtonColor:"#C2B593",iconColor:"#8d2430",border:"none"}):this.mail=!0},onSubmit(t){if(""===this.title||""===this.textarea)this.$swal.fire({icon:"error",title:"錯誤",text:"主旨或內文不可空白",confirmButtonColor:"#C2B593",iconColor:"#8d2430",border:"none"});else{const t={name:this.master[0].name,_id:this.master[0]._id,title:this.title,description:this.textarea};this.axios.patch("https://petcle.herokuapp.com/pets/mail/"+this.petpage._id,t).then((t=>{t.data.success?(this.$swal.fire({icon:"success",title:"成功送出",confirmButtonColor:"#C2B593",iconColor:"#56C6BF",border:"none"}),this.mail=!1):this.$swal.fire({icon:"error",title:"送出失敗",confirmButtonColor:"#C2B593",iconColor:"#8d2430",border:"none"})})),this.axios.patch("https://petcle.herokuapp.com/pets/sendMail/"+this.getUserPet[0]._id,t)}},onReset(){this.title="",this.textarea=""}},mounted(){this.axios.get("https://petcle.herokuapp.com/pets/"+this.$route.params.id).then((t=>{console.log(this.$route.params.id),t.data.success?(this.petpage=t.data.result,this.petpage.src="https://petcle.herokuapp.com/pets/file/"+this.petpage.file):this.$swal.fire({icon:"error",title:"錯誤",confirmButtonColor:"#C2B593",iconColor:"#8d2430",border:"none"})})).catch((t=>{console.log(t)})),this.axios.get("https://petcle.herokuapp.com/users/").then((t=>{t.data.success?this.allUsers=t.data.result.map((t=>t)):this.$swal.fire({icon:"error",title:"錯誤",confirmButtonColor:"#C2B593",iconColor:"#8d2430",border:"none"})})),this.axios.get("https://petcle.herokuapp.com/pets/").then((t=>{t.data.success?this.allPets=t.data.result.map((t=>t)):this.$swal.fire({icon:"error",title:"錯誤",confirmButtonColor:"#C2B593",iconColor:"#8d2430",border:"none"})}))}}),o=r,l=s("2877"),c=s("9989"),n=s("9c40"),p=s("24e8"),d=s("f09f"),u=s("0016"),m=s("0378"),h=s("27f9"),f=s("7f67"),C=s("eebe"),b=s.n(C),g=Object(l["a"])(o,a,i,!1,null,null,null);e["default"]=g.exports;b()(g,"components",{QPage:c["a"],QBtn:n["a"],QDialog:p["a"],QCard:d["a"],QIcon:u["a"],QForm:m["a"],QInput:h["a"]}),b()(g,"directives",{ClosePopup:f["a"]})}}]);